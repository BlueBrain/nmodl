steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '$(python.version)'
  - task: TwineAuthenticate@1
    inputs:
      pythonUploadServiceConnection: AzureNMODLPypiNightly
    condition: and(succeeded(), in(variables['Build.Reason'], 'Manual', 'Schedule'), ne(variables['NMODL_NIGHTLY_UPLOAD'], 'false'))
  - script: |
      python -m pip install twine
      python -m twine upload --verbose --skip-existing -r NMODLPypiNightly --config-file $(PYPIRC_PATH) wheelhouse/*.whl
    condition: and(succeeded(), in(variables['Build.Reason'], 'Manual', 'Schedule'), ne(variables['NMODL_NIGHTLY_UPLOAD'], 'false'))
    displayName: 'Upload nightly wheel to pypi.org'
  - task: TwineAuthenticate@1
    inputs:
      pythonUploadServiceConnection: AzureNMODLPypi
    condition: and(succeeded(), in(variables['Build.Reason'], 'Manual'), eq(variables['NMODL_RELEASE_UPLOAD'], 'true'))

  - script: |
      python -m pip install twine
      python -m twine upload --verbose --skip-existing -r NMODLPypi --config-file $(PYPIRC_PATH) wheelhouse/*.whl
    condition: and(succeeded(), in(variables['Build.Reason'], 'Manual'), eq(variables['NMODL_RELEASE_UPLOAD'], 'true'))
    displayName: 'Upload release wheel to pypi.org'
